create database if not exists Twitter;

create schema if not exists twitter_data;

--We will be using the same schema and database and notification ARN configurations between snowpipe and S3 bucket.
create or replace table twitter_data_2
(
    author varchar(500),
    content varchar(2000),
    date_time timestamp,
    language varchar(5),
    number_of_likes int,
    number_of_shares int,
    created_by varchar(50) default current_user(),
    created_date timestamp default current_timestamp()
);

desc table twitter_data_2;

create or replace pipe twitter_data_2
auto_ingest = True
as
copy into twitter_data_2(author,content,date_time,language,number_of_likes,number_of_shares)
from (select $1,	$2,$3,	$4,	$5,$6 from @twiiter_aws)

select * from @twiiter_aws

desc pipe twitter_data_2

select * from twitter_data_2
where created_date <= current_timestamp

select *
  from table(information_schema.validate_pipe_load(
    pipe_name => 'twitter_data_2',
    start_time=>dateadd('minute',-30,current_timestamp()))),
    end_time => dateadd(day,0,current_timestamp())))

select *
  from table(information_schema.pipe_usage_history(
    date_range_start=>dateadd('day',0,current_date())));
select current_timestamp();

